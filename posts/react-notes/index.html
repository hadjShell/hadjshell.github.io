<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>React Notes | Hadjshell</title>
<meta name=keywords content="ÂàÄÊ≥ï(How to play with swordüó°Ô∏è),React"><meta name=description content="React.js Note Intro React is a JavaScript library for rendering UI Components React is all about Components A component is a piece of the UI that has its own logic and appearance We don&rsquo;t have to manipulate DOM manually anymore with components A component is just a JavaScript function Their names always begin with a capital letter They return JSX markup React application begins at a &ldquo;root&rdquo; component JSX JavaScript XML A syntax extension for JavaScript that lets you write HTML-like markup inside a ."><meta name=author content="Jiayuan Zhang"><link rel=canonical href=https://hadjshell.github.io/posts/react-notes/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://hadjshell.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://hadjshell.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://hadjshell.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://hadjshell.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://hadjshell.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="React Notes"><meta property="og:description" content="React.js Note Intro React is a JavaScript library for rendering UI Components React is all about Components A component is a piece of the UI that has its own logic and appearance We don&rsquo;t have to manipulate DOM manually anymore with components A component is just a JavaScript function Their names always begin with a capital letter They return JSX markup React application begins at a &ldquo;root&rdquo; component JSX JavaScript XML A syntax extension for JavaScript that lets you write HTML-like markup inside a ."><meta property="og:type" content="article"><meta property="og:url" content="https://hadjshell.github.io/posts/react-notes/"><meta property="og:image" content="https://hadjshell.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-11T00:00:00+00:00"><meta property="article:modified_time" content="2023-12-11T00:00:00+00:00"><meta property="og:site_name" content="Hadjshell Blog Site"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hadjshell.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="React Notes"><meta name=twitter:description content="React.js Note Intro React is a JavaScript library for rendering UI Components React is all about Components A component is a piece of the UI that has its own logic and appearance We don&rsquo;t have to manipulate DOM manually anymore with components A component is just a JavaScript function Their names always begin with a capital letter They return JSX markup React application begins at a &ldquo;root&rdquo; component JSX JavaScript XML A syntax extension for JavaScript that lets you write HTML-like markup inside a ."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://hadjshell.github.io/posts/"},{"@type":"ListItem","position":2,"name":"React Notes","item":"https://hadjshell.github.io/posts/react-notes/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"React Notes","name":"React Notes","description":"React.js Note Intro React is a JavaScript library for rendering UI Components React is all about Components A component is a piece of the UI that has its own logic and appearance We don\u0026rsquo;t have to manipulate DOM manually anymore with components A component is just a JavaScript function Their names always begin with a capital letter They return JSX markup React application begins at a \u0026ldquo;root\u0026rdquo; component JSX JavaScript XML A syntax extension for JavaScript that lets you write HTML-like markup inside a .","keywords":["ÂàÄÊ≥ï(How to play with swordüó°Ô∏è)","React"],"articleBody":"React.js Note Intro React is a JavaScript library for rendering UI Components React is all about Components A component is a piece of the UI that has its own logic and appearance We don‚Äôt have to manipulate DOM manually anymore with components A component is just a JavaScript function Their names always begin with a capital letter They return JSX markup React application begins at a ‚Äúroot‚Äù component JSX JavaScript XML A syntax extension for JavaScript that lets you write HTML-like markup inside a .js file Rules of JSX Return a single root element React.createElement() is invoked behind the scene Built-in tag Alternatively written as \u003c\u003e...\u003c/\u003e It‚Äôs an empty tag Let you group things without leaving any trace in the browser HTML tree All tags must be closed camelCase all most of the things HTML and SVG attributes are written in camelCase For historical reasons, aria-* and data-* attributes are written as in HTML with dashes Dynamic data: {} As text directly inside a JSX tag As attributes immediately following the = sign Any JavaScript expression will work between curly braces, including function calls Fundamentally, JSX just provides a syntactic sugar for the React.createElement function props props are the information that you pass to a JSX tag\nProcess\nSet props: Add custom attributes onto the custom HTML elements (components) Merge into object: React merges all props into a single object Receive props: Components (the function) will accept the props as the first argument Conventionally the parameter is named with props\nUsually you don‚Äôt need the whole props object itself, so destruct it into individual prop\nPass props through multiple components\nfunction Profile(props) { return ( \u003cdiv className=\"card\"\u003e \u003cAvatar {...props} /\u003e \u003c/div\u003e ); } De-constructing or setting default values on props: ... Composition of components\nWhen you nest component in another component, the parent component will receive that content in props\n{props.children}\nLike a wrapper\nimport Avatar from \"./Avatar.js\"; function Card({ children }) { return \u003cdiv className=\"card\"\u003e{children}\u003c/div\u003e; } export default function Profile() { return ( \u003cCard\u003e \u003cAvatar size={100} person={{ name: \"Katsuko Saruhashi\", imageId: \"YfeOqp2\", }} /\u003e \u003c/Card\u003e ); } Trick: Pass a component identifier as a value for a prop to dynamically render different components inside a component\nThat prop should be named with a start of capital letter The value: default element: ; customised element: props are immutable When a component needs to change its props (for example, in response to a user interaction or new data), it will have to ‚Äúask‚Äù its parent component to pass it different props‚Äî a new object Conditional Rendering Shortcuts: ? : , \u0026\u0026 Rendering Lists map, filter: array of objects to array of JSX markup\nkey\nYou need to give each array item a key A string or a number that uniquely identifies it among other items in that array Useful for future manipulations Do NOT generate key on the fly, instead you should include them in your data Where to get your key Data from a database or API: use their keys Locally generated data: use an incrementing counter crypto.randomUUID() or a package like uuid when creating items The components won‚Äôt receive key as a prop, it‚Äôs only used as a hint by React itself export default function List({ people }) { const listItems = people.map(person =\u003e ( \u003cli key={person.id}\u003e{person.name}\u003c/li\u003e )); return \u003cul\u003e{listItems}\u003c/ul\u003e; } Keep Components Pure Components should only return their JSX, and not change any objects or variables that existed before rendering\nIt‚Äôs totally okay to change variables and objects that you‚Äôve just created while rendering inside the component functions React offers a ‚ÄúStrict mode‚Äù in which it calls each component‚Äôs function twice during development\nBy calling the component functions twice, strict mode helps find components that break these rules\nStrict mode has no effect in production\nSide effects\nIn React, side effects usually belong inside event handlers Even though event handlers are defined inside your component, they don‚Äôt run during rendering! So event handlers don‚Äôt need to be pure As a last resort, use useEffect Interactivity Event Handlers You can respond to events by declaring event handler functions inside the components\nexport default function Button() { function handleClick() { alert(\"You clicked me!\"); } return \u003cbutton onClick={handleClick}\u003eClick me\u003c/button\u003e; } // if the handler accept parameters, a common pattern for using it is: // ","wordCount":"7466","inLanguage":"en","datePublished":"2023-12-11T00:00:00Z","dateModified":"2023-12-11T00:00:00Z","author":{"@type":"Person","name":"Jiayuan Zhang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://hadjshell.github.io/posts/react-notes/"},"publisher":{"@type":"Organization","name":"Hadjshell","logo":{"@type":"ImageObject","url":"https://hadjshell.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hadjshell.github.io/ accesskey=h title="Hadjshell (Alt + H)"><img src=https://hadjshell.github.io/apple-touch-icon.png alt aria-label=logo height=35>Hadjshell</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://hadjshell.github.io/ title=Home><span>Home</span></a></li><li><a href=https://hadjshell.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://hadjshell.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://hadjshell.github.io/about/ title="About Me"><span>About Me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>React Notes</h1><div class=post-meta><span title='2023-12-11 00:00:00 +0000 UTC'>Dec 11 2023</span>&nbsp;¬∑&nbsp;36 min&nbsp;¬∑&nbsp;Jiayuan Zhang</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#components>Components</a><ul><li><a href=#jsx>JSX</a></li><li><a href=#props><code>props</code></a></li><li><a href=#conditional-rendering>Conditional Rendering</a></li><li><a href=#rendering-lists>Rendering Lists</a></li><li><a href=#keep-components-pure>Keep Components <strong>Pure</strong></a></li></ul></li><li><a href=#interactivity>Interactivity</a><ul><li><a href=#event-handlers>Event Handlers</a></li><li><a href=#state><code>state</code></a></li><li><a href=#trigger-render-and-commit>Trigger, Render and Commit</a></li><li><a href=#queueing-a-series-of-state-updates>Queueing a series of <code>state</code> updates</a></li><li><a href=#updating-objects-or-arrays-in-state>Updating Objects or Arrays in <code>state</code></a></li><li><a href=#component-lifecycle>Component Lifecycle</a></li></ul></li><li><a href=#managing-state>Managing <code>state</code></a><ul><li><a href=#thinking-about-ui-declaratively>Thinking about UI declaratively</a></li><li><a href=#principle-for-structuring-state>Principle for structuring <code>state</code></a></li><li><a href=#sharing-state-between-components>Sharing <code>state</code> between components</a></li><li><a href=#react-maintain-an-ui-tree-like-dom>React maintain an UI tree (like DOM)</a></li><li><a href=#context-api>Context API</a></li><li><a href=#reducer>Reducer</a></li></ul></li><li><a href=#refs><code>refs</code></a><ul><li><a href=#what-is-refs>What is <code>refs</code></a></li><li><a href=#manipulating-dom-with-refs>Manipulating DOM with <code>refs</code></a></li></ul></li><li><a href=#dealing-with-effects>Dealing with <code>Effects</code></a><ul><li><a href=#what-is-effects>What is <code>Effects</code></a></li><li><a href=#effects--dependencies><code>effects</code> & <code>dependencies</code></a></li><li><a href=#when-not-to-use-useeffect>When NOT to use <code>useEffect()</code></a></li></ul></li><li><a href=#react-hooks>React Hooks</a><ul><li><a href=#usecallbackhttpsreactdevreferencereactusecallback><a href=https://react.dev/reference/react/useCallback><code>useCallback()</code></a></a></li><li><a href=#usememohttpsreactdevreferencereactusememo><a href=https://react.dev/reference/react/useMemo><code>useMemo()</code></a></a></li><li><a href=#custom-hooks>Custom Hooks</a></li></ul></li><li><a href=#debugging-react-apps>Debugging React Apps</a></li><li><a href=#class-based-components>Class-Based Components</a><ul><li><a href=#what--why>What & Why</a></li><li><a href=#working-with-class-based-components>Working with Class-Based Components</a></li><li><a href=#error-boundaries>Error Boundaries</a></li></ul></li><li><a href=#handling-http-request>Handling HTTP Request</a><ul><li><a href=#how-to-connect-a-back-end--database>How to Connect a Back-end / Database</a></li><li><a href=#fetching-data>Fetching Data</a></li><li><a href=#sending-data>Sending Data</a></li></ul></li><li><a href=#working-with-forms--user-input>Working with Forms & User Input</a><ul><li><a href=#what-is-form>What is Form</a></li><li><a href=#handling-form-submission>Handling Form Submission</a></li><li><a href=#validating-user-input>Validating User Input</a></li><li><a href=#building-custom-solutions>Building Custom Solutions</a></li></ul></li><li><a href=#redux>Redux</a><ul><li><a href=#what-is-redux>What is Redux</a></li><li><a href=#why-using-redux>Why using Redux</a></li><li><a href=#how-to-use-redux>How to use Redux</a></li><li><a href=#redux-application-data-flow>Redux Application Data Flow</a></li></ul></li><li><a href=#react-router>React Router</a></li><li><a href=#authentication>Authentication</a></li><li><a href=#styling-react-components>Styling React Components</a><ul><li><a href=#styling-with-vanilla-css>Styling with vanilla CSS</a></li><li><a href=#scoping-styles>Scoping Styles</a></li><li><a href=#styling-with-tailwind-css>Styling with Tailwind CSS</a></li><li><a href=#dynamic-styling>Dynamic Styling</a></li><li><a href=#animating>Animating</a></li></ul></li><li><a href=#testing>Testing</a></li><li><a href=#deployment>Deployment</a></li><li><a href=#references>References</a></li></ul></nav></div></details></div><div class=post-content><h1 id=reactjs-note>React.js Note<a hidden class=anchor aria-hidden=true href=#reactjs-note>#</a></h1><hr><h2 id=intro>Intro<a hidden class=anchor aria-hidden=true href=#intro>#</a></h2><ul><li>React is a JavaScript library for rendering UI</li></ul><hr><h2 id=components>Components<a hidden class=anchor aria-hidden=true href=#components>#</a></h2><ul><li>React is all about <em>Components</em></li><li>A component is a piece of the UI that has its own logic and appearance</li><li>We don&rsquo;t have to manipulate DOM manually anymore with components</li><li><strong>A component is just a JavaScript function</strong><ul><li>Their names always begin with a capital letter</li><li>They return JSX markup</li></ul></li><li>React application begins at a &ldquo;root&rdquo; component</li></ul><h3 id=jsx>JSX<a hidden class=anchor aria-hidden=true href=#jsx>#</a></h3><ul><li>JavaScript XML</li><li>A syntax extension for JavaScript that lets you write HTML-like markup inside a <code>.js</code> file</li><li>Rules of JSX<ul><li>Return a single root element<ul><li><code>React.createElement()</code> is invoked behind the scene</li><li>Built-in tag <code>&lt;Fragment></code><ul><li>Alternatively written as <code>&lt;>...&lt;/></code></li><li>It&rsquo;s an empty tag</li><li>Let you group things without leaving any trace in the browser HTML tree</li></ul></li></ul></li><li>All tags must be closed</li><li><code>camelCase </code><del>all</del> most of the things<ul><li>HTML and SVG attributes are written in <code>camelCase</code></li><li>For historical reasons, <a href=https://developer.mozilla.org/docs/Web/Accessibility/ARIA><code>aria-*</code></a> and <a href=https://developer.mozilla.org/docs/Learn/HTML/Howto/Use_data_attributes><code>data-*</code></a> attributes are written as in HTML with dashes</li></ul></li></ul></li><li>Dynamic data: <code>{}</code><ul><li><strong>As text</strong> directly inside a JSX tag</li><li><strong>As attributes</strong> immediately following the <code>=</code> sign</li><li>Any JavaScript expression will work between curly braces, including function calls</li></ul></li><li>Fundamentally, JSX just provides a syntactic sugar for the <code>React.createElement</code> function</li></ul><h3 id=props><code>props</code><a hidden class=anchor aria-hidden=true href=#props>#</a></h3><ul><li><p><code>props</code> are the information that you pass to a JSX tag</p></li><li><p>Process</p><ul><li>Set <code>props</code>: Add <strong>custom attributes</strong> onto the custom HTML elements (components)</li><li>Merge into object: React merges all <code>props</code> into a single object</li><li>Receive <code>props</code>: Components (the function) will accept the <code>props</code> as the first argument</li></ul></li><li><p>Conventionally the parameter is named with <code>props</code></p></li><li><p>Usually you don&rsquo;t need the whole <code>props</code> object itself, so destruct it into individual <code>prop</code></p></li><li><p>Pass <code>props</code> through multiple components</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Profile</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>className</span><span class=o>=</span><span class=s>&#34;card&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>Avatar</span> <span class=p>{</span><span class=na>...props</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>De-constructing or setting default values on <code>props</code>: <code>...</code></li></ul></li><li><p>Composition of components</p><ul><li><p>When you nest component in another component, the parent component will receive that content in <code>props</code></p></li><li><p><code>{props.children}</code></p></li><li><p>Like a wrapper</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Avatar</span> <span class=nx>from</span> <span class=s2>&#34;./Avatar.js&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Card</span><span class=p>({</span> <span class=nx>children</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>div</span> <span class=na>className</span><span class=o>=</span><span class=s>&#34;card&#34;</span><span class=p>&gt;{</span><span class=nx>children</span><span class=p>}&lt;/</span><span class=nt>div</span><span class=p>&gt;;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>Profile</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>Card</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>Avatar</span>
</span></span><span class=line><span class=cl>        <span class=na>size</span><span class=o>=</span><span class=p>{</span><span class=mi>100</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=na>person</span><span class=o>=</span><span class=p>{{</span>
</span></span><span class=line><span class=cl>          <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Katsuko Saruhashi&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>imageId</span><span class=o>:</span> <span class=s2>&#34;YfeOqp2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}}</span>
</span></span><span class=line><span class=cl>      <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>Card</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul></li></ul><blockquote><p><strong>Trick</strong>: Pass a component identifier as a value for a <code>prop</code> to dynamically render different components inside a component</p><ul><li>That <code>prop</code> should be named with a start of capital letter</li><li>The value: default element: ; customised element:</li></ul></blockquote><ul><li><code>props</code> are <strong>immutable</strong><ul><li>When a component needs to change its props (for example, in response to a user interaction or new data), it will have to ‚Äúask‚Äù its parent component to pass it different <code>props</code>‚Äî <em>a new object</em></li></ul></li></ul><h3 id=conditional-rendering>Conditional Rendering<a hidden class=anchor aria-hidden=true href=#conditional-rendering>#</a></h3><ul><li>Shortcuts: <code>&lt;condition> ? &lt;content1> : &lt;content2></code>, <code>&lt;condition> && &lt;content></code></li></ul><h3 id=rendering-lists>Rendering Lists<a hidden class=anchor aria-hidden=true href=#rendering-lists>#</a></h3><ul><li><p><code>map</code>, <code>filter</code>: array of objects to array of JSX markup</p></li><li><p><strong><code>key</code></strong></p><ul><li>You need to give each array item a <code>key</code></li><li>A string or a number that uniquely identifies it among other items in that array</li><li>Useful for future manipulations</li><li>Do <strong>NOT</strong> generate <code>key</code> on the fly, instead you should include them in your data</li><li>Where to get your <code>key</code><ul><li>Data from a database or API: use their keys</li><li>Locally generated data: use an incrementing counter <a href=https://developer.mozilla.org/en-US/docs/Web/API/Crypto/randomUUID><code>crypto.randomUUID()</code></a> or a package like <a href=https://www.npmjs.com/package/uuid><code>uuid</code></a> when creating items</li></ul></li><li><strong>The components won&rsquo;t receive <code>key</code> as a <code>prop</code></strong>, it&rsquo;s only used as a hint by React itself</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>List</span><span class=p>({</span> <span class=nx>people</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>listItems</span> <span class=o>=</span> <span class=nx>people</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>person</span> <span class=p>=&gt;</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>li</span> <span class=na>key</span><span class=o>=</span><span class=p>{</span><span class=nx>person</span><span class=p>.</span><span class=nx>id</span><span class=p>}&gt;{</span><span class=nx>person</span><span class=p>.</span><span class=nx>name</span><span class=p>}&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;{</span><span class=nx>listItems</span><span class=p>}&lt;/</span><span class=nt>ul</span><span class=p>&gt;;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul><h3 id=keep-components-pure>Keep Components <strong>Pure</strong><a hidden class=anchor aria-hidden=true href=#keep-components-pure>#</a></h3><ul><li><p>Components should only return their JSX, and not change any objects or variables that existed before rendering</p><ul><li>It&rsquo;s totally okay to change variables and objects that you&rsquo;ve just created while rendering inside the component functions</li></ul></li><li><p>React offers a &ldquo;Strict mode&rdquo; in which it calls each component&rsquo;s function twice during development</p></li><li><p>By calling the component functions twice, strict mode helps find components that break these rules</p></li><li><p>Strict mode has no effect in production</p></li><li><p><a href=#dealing-with-effects>Side effects</a></p><ul><li>In React, <strong>side effects usually belong inside event handlers</strong></li><li>Even though event handlers are defined <em>inside</em> your component, they don‚Äôt run <em>during</em> rendering! <strong>So event handlers don‚Äôt need to be pure</strong></li><li>As a last resort, use <code>useEffect</code></li></ul></li></ul><hr><h2 id=interactivity>Interactivity<a hidden class=anchor aria-hidden=true href=#interactivity>#</a></h2><h3 id=event-handlers>Event Handlers<a hidden class=anchor aria-hidden=true href=#event-handlers>#</a></h3><ul><li><p>You can respond to events by declaring event handler functions <strong>inside the components</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>Button</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>handleClick</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>alert</span><span class=p>(</span><span class=s2>&#34;You clicked me!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>handleClick</span><span class=p>}&gt;</span><span class=nx>Click</span> <span class=nx>me</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// if the handler accept parameters, a common pattern for using it is:
</span></span></span><span class=line><span class=cl><span class=c1>// &lt;button onClick={() =&gt; handleClick(params)}&gt;Click me&lt;/button&gt;
</span></span></span></code></pre></div></li><li><p>Often you&rsquo;ll want the parent component to specify a child&rsquo;s event handler and pass it to the child as a <code>prop</code></p></li><li><p>By convention, handlers should start with <code>handle</code>; handlers <code>prop</code> should start with <code>on</code></p></li><li><p>On all built-in HTML elements we have full access to all native DOM events</p></li><li><p>Built-in components only support browser event names</p></li><li><p>Custom components can have custom handler name</p></li><li><p>Event handlers receive an <strong>event object</strong> as their only argument. By convention, it‚Äôs usually called <code>e</code></p></li><li><p>All events propagate in React except <code>onScroll</code>, which only works on the JSX tag you attach it to</p><ul><li>Stop propagation: <code>e.stopPropagation()</code></li></ul></li><li><p><code>e.preventDefault()</code></p></li></ul><h3 id=state><code>state</code><a hidden class=anchor aria-hidden=true href=#state>#</a></h3><ul><li><p>Why local variable isn&rsquo;t enough</p><ul><li><strong>Local variables don‚Äôt persist between renders.</strong> When React renders this component a second time, it renders it from scratch‚Äîit doesn‚Äôt consider any changes to the local variables</li><li><strong>Changes to local variables won‚Äôt trigger renders.</strong> React doesn‚Äôt realize it needs to render the component again with the new data</li></ul></li><li><p>To update a component with new data, two things need to happen:</p><ul><li><strong>Retain</strong> the data between renders</li><li><strong>Trigger</strong> React to render the component with new data (re-rendering)</li></ul></li><li><p><code>state</code> is the component-specific memory</p></li><li><p><code>useState(initialState)</code></p><ul><li>A React Hook that lets you add a state variable to your component</li><li><code>initialState</code><ul><li>The value you want the <code>state</code> to be initially</li></ul></li><li>Returns<ul><li>The current <code>state</code> variable to retain data between renders</li><li>The <code>set</code> function that lets you update the state to a different value and trigger a re-render<ul><li>The <code>set</code> function <strong>only updates the state variable for the next render</strong></li></ul></li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Component</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>title</span><span class=p>,</span> <span class=nx>setTitle</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=nx>props</span><span class=p>.</span><span class=nx>title</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li><li><p>You can have as many state variables of as many types as you like in one component</p></li><li><p><code>state</code> is isolated and private</p><ul><li>If you render the same component multiple times, each will get its own state</li><li>State is fully private to the component declaring it, the parent component cannot change it</li></ul></li><li><p><strong>A <code>state</code> variable&rsquo;s value never changes within a render, even if its event handler&rsquo;s code is asynchronous</strong></p></li><li><p><strong><code>props</code> vs. <code>state</code></strong></p><ul><li><a href=https://react.dev/learn/passing-props-to-a-component><strong>Props</strong> are like arguments you pass</a> to a function. They let a parent component pass data to a child component and customize its appearance. For example, a <code>Form</code> can pass a <code>color</code> <code>prop</code> to a <code>Button</code></li><li><a href=https://react.dev/learn/state-a-components-memory><strong>State</strong> is like a component‚Äôs memory.</a> It lets a component keep track of some information and change it in response to interactions. For example, a <code>Button</code> might keep track of <code>isHovered</code> state</li></ul></li></ul><h3 id=trigger-render-and-commit>Trigger, Render and Commit<a hidden class=anchor aria-hidden=true href=#trigger-render-and-commit>#</a></h3><ul><li><p>The process of requesting and serving UI</p><ol><li>Triggering a render<ul><li>Component&rsquo;s initial render, or</li><li>The component&rsquo;s (or one of its ancestors) <code>state</code> has been updated</li></ul></li><li>Rendering the component (<strong>Calling your component function</strong>)<ul><li>On initial render, React will call the root component <code>root.render()</code></li><li>For <strong>subsequent renders</strong>, React will call the function component whose <code>state</code> update triggered the render (this process is recursive)<blockquote><p>You may have thought about the performance issue, look at the <a href=https://legacy.reactjs.org/docs/optimizing-performance.html>Performance section</a></p></blockquote></li></ul></li><li>Committing to the DOM<ul><li>For the initial render, React will use <code>appendChild()</code> DOM API to put all the DOM nodes it has created on the screen</li><li>For re-renders, React will apply the **minimal **necessary operations to make the DOM match the latest rendering output<ul><li>With the help of a virtual DOM</li></ul></li></ul></li><li>Browser paint the screen</li></ol></li><li><p>Optimisation by avoiding unnecessary component function execution</p><ul><li><p><code>memo()</code></p><ul><li>Wrap the component function as a parameter of <code>memo()</code></li><li>Component function won&rsquo;t execute if the <code>props</code> value are the same</li><li>Blocking a component execution will also block all children components execution</li><li>However,<ul><li>Don&rsquo;t overuse <code>memo()</code></li><li>Use it as high up in the component tree as possible</li><li>Checking <code>props</code> with <code>memo()</code> costs performance</li><li>Don&rsquo;t use it on components where <code>props</code> change frequently</li></ul></li></ul></li><li><p>Refactor your project to a clever structure</p></li></ul></li></ul><h3 id=queueing-a-series-of-state-updates>Queueing a series of <code>state</code> updates<a hidden class=anchor aria-hidden=true href=#queueing-a-series-of-state-updates>#</a></h3><ul><li><p>Batching</p><ul><li>React waits until all code in the event handlers or <code>useEffect()</code> has run before processing your state updates</li></ul></li><li><p>Update <code>state</code> <strong>based on its previous value</strong></p><ul><li><p>Pass <strong>a function</strong> to <code>setSomething</code> as <code>nextState</code>, which will be treated as an <strong>updater function</strong></p></li><li><p><a href=https://react.dev/reference/react/useState#setstate>Reference</a></p></li><li><p>Updater functions must be <strong>pure</strong> and only <strong>return the result</strong></p></li><li><p><strong>React queues this function to be processed after all the other code in the event handler has run</strong></p></li><li><p>During the next render, React goes through the queue and gives you <strong>the latest updated <code>state</code></strong></p></li><li><p>By convention, name the updater function argument by the first letters of the corresponding <code>state</code> variable</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>Counter</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>number</span><span class=p>,</span> <span class=nx>setNumber</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;{</span><span class=nx>number</span><span class=p>}&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span>
</span></span><span class=line><span class=cl>        <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>setNumber</span><span class=p>(</span><span class=nx>n</span> <span class=p>=&gt;</span> <span class=nx>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=nx>setNumber</span><span class=p>(</span><span class=nx>n</span> <span class=p>=&gt;</span> <span class=nx>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=nx>setNumber</span><span class=p>(</span><span class=nx>n</span> <span class=p>=&gt;</span> <span class=nx>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}}</span>
</span></span><span class=line><span class=cl>      <span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>+</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul></li><li><p>Update the DOM synchronously</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=nx>flushSync</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>setTodos</span><span class=p>([</span> <span class=p>...</span><span class=nx>todos</span><span class=p>,</span> <span class=nx>newTodo</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>listRef</span><span class=p>.</span><span class=nx>current</span><span class=p>.</span><span class=nx>lastChild</span><span class=p>.</span><span class=nx>scrollIntoView</span><span class=p>();</span>
</span></span></code></pre></div><ul><li>This will instruct React to update the DOM synchronously right after the code wrapped in <code>flushSync</code> executes</li></ul><blockquote><p>Using <code>flushSync</code> is uncommon and can hurt the performance of your app</p></blockquote></li></ul><h3 id=updating-objects-or-arrays-in-state>Updating Objects or Arrays in <code>state</code><a hidden class=anchor aria-hidden=true href=#updating-objects-or-arrays-in-state>#</a></h3><ul><li>You shouldn&rsquo;t change objects or arrays that you hold in the <code>state</code> directly</li><li>Instead, when you want to update it, you need to create a new one (or make a copy of an existing one), and then set the <code>state</code> to use the copy</li><li>Treat <code>state</code> as <strong>immutable</strong></li><li>Updating a nested object or array of objects: <a href=https://github.com/immerjs/use-immer>Immer</a><ul><li>To achieve deep clone</li><li>How to use Immer<ul><li>Run <code>npm install use-immer</code> to add Immer as a dependency</li><li>Replace <code>import { useState } from 'react'</code> with <code>import { useImmer } from 'use-immer'</code></li><li>Now you can change the <code>state</code> directly inside the updater function (<strong>syntax sugar</strong>)</li></ul></li></ul></li></ul><h3 id=component-lifecycle>Component Lifecycle<a hidden class=anchor aria-hidden=true href=#component-lifecycle>#</a></h3><ul><li>A component <em>mounts</em> when it‚Äôs added to the screen</li><li>A component <em>updates</em> when it receives new <code>props</code> or <code>state</code>, usually in response to an interaction</li><li>A component <em>unmounts</em> when it‚Äôs removed from the screen</li><li>All values declare in the component body are reactive</li></ul><hr><h2 id=managing-state>Managing <code>state</code><a hidden class=anchor aria-hidden=true href=#managing-state>#</a></h2><h3 id=thinking-about-ui-declaratively>Thinking about UI declaratively<a hidden class=anchor aria-hidden=true href=#thinking-about-ui-declaratively>#</a></h3><ul><li><p>Identify component&rsquo;s different visual states</p><ul><li>Treat component as a <strong><em>state machine</em></strong></li><li>Have a <code>state</code> variable - <code>status</code>, and let it decide how the component should look like (return different markup)</li></ul></li><li><p>Determine the human or computer events that trigger those state changes</p><ul><li>Set <code>state</code> variables to update UI</li></ul></li><li><p>Represent the <code>state</code> in memory with <code>useState</code></p></li><li><p>Remove any non-essential <code>state</code></p><ul><li>Derive values from essential <code>states</code></li></ul></li><li><p>Connect the event handlers to <code>setState</code></p><blockquote><p>Components wrap controller and view together, but make them much easier to code and much less fragile</p></blockquote></li></ul><h3 id=principle-for-structuring-state>Principle for structuring <code>state</code><a hidden class=anchor aria-hidden=true href=#principle-for-structuring-state>#</a></h3><ul><li>Group related state</li><li>Avoid contradiction</li><li>Avoid redundancy</li><li>Avoid duplication</li><li>Avoid deeply nested <code>state</code></li></ul><h3 id=sharing-state-between-components>Sharing <code>state</code> between components<a hidden class=anchor aria-hidden=true href=#sharing-state-between-components>#</a></h3><ul><li><strong>Lifting <code>state</code> up</strong><ul><li>Sometimes, you want the <code>state</code> of two components to always change together. To do it, remove <code>state</code> from both of them, move it to their closest common parent, and then pass <code>state</code> and <code>setState</code> down to them <strong>via <code>props</code></strong></li></ul></li><li>Uncontrolled components: components with local <code>state</code></li><li>Controlled component: the important information in it is driven by <code>props</code> rather than its own local <code>state</code></li><li>When writing a component, consider which information in it should be controlled (<em>via <code>props</code></em>), and which information should be uncontrolled (<em>via <code>state</code></em>)</li><li><strong>Single source of truth</strong></li></ul><h3 id=react-maintain-an-ui-tree-like-dom>React maintain an UI tree (like DOM)<a hidden class=anchor aria-hidden=true href=#react-maintain-an-ui-tree-like-dom>#</a></h3><ul><li><p><code>state</code> is tied to a <strong><em>position</em></strong> and <strong><em>component type</em></strong> in the tree</p><ul><li><strong><code>state</code> is held inside React instead of &ldquo;living&rdquo; inside the component</strong></li><li>React preserves a component‚Äôs <code>state</code> for as long as it‚Äôs being rendered at its position in the UI tree. If it gets removed, or a different component gets rendered at the same position, React discards its <code>state</code></li><li><strong>It&rsquo;s the position in the UI tree</strong> - not in the JSX markup<ul><li>Same components at the same position preserves <code>state</code></li><li>Different components at the same position reset <code>state</code></li></ul></li></ul></li><li><p><code>key</code> can be used to make React distinguish between any components</p><ul><li><p><code>key</code> isn&rsquo;t just for lists</p></li><li><p><code>key</code> is not globally unique, they only specify the position within the parent</p><blockquote><p><strong>Trick</strong>: Use <code>key</code> for <strong>resetting components at the same position</strong></p><ul><li>React will destroy the old component instance if the value of <code>key</code> has changed</li><li>Unmount and remount the component</li></ul></blockquote></li></ul></li></ul><h3 id=context-api>Context API<a hidden class=anchor aria-hidden=true href=#context-api>#</a></h3><ul><li><p>Prop drilling: passing shared data through multiple components layers</p><ul><li><p>It can be a problem when you have too many <code>state</code> to manage</p></li><li><p>Solution 1: Component Composition</p></li></ul></li><li><p><strong><code>Context</code></strong></p><ul><li><p>Lets the parent component make some information available to any component in the tree below it‚Äîno matter how deep‚Äîwithout passing it explicitly through <code>props</code></p></li><li><p><strong>How to use <code>Context</code></strong></p><ol><li><p>Create the context</p><ul><li><p>Create a context in a new file and export it</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// LevelContext.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>createContext</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>LevelContext</span> <span class=o>=</span> <span class=nx>createContext</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// note: the value cannot only be states
</span></span></span></code></pre></div></li><li><p>The only argument to <code>createContext</code> is the <em>default</em> value</p></li></ul></li><li><p>Provide the context</p><ul><li><p>If you don‚Äôt provide the context, React will use the default value</p></li><li><p>Wrap the component who provide context with a context provider</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// Section.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>LevelContext</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;./LevelContext.js&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>Section</span><span class=p>({</span> <span class=nx>level</span><span class=p>,</span> <span class=nx>children</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>section</span> <span class=na>className</span><span class=o>=</span><span class=s>&#34;section&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>LevelContext.Provider</span> <span class=na>value</span><span class=o>=</span><span class=p>{</span><span class=nx>level</span><span class=p>}&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* This tells React:
</span></span></span><span class=line><span class=cl><span class=cm>      		If any component inside &lt;Section&gt; ask for `LevelContext,
</span></span></span><span class=line><span class=cl><span class=cm>      		give them this `level`.
</span></span></span><span class=line><span class=cl><span class=cm>      		The component will use the value of the nearest
</span></span></span><span class=line><span class=cl><span class=cm>      		&lt;LevelContext.Provider&gt; in the UI tree above it
</span></span></span><span class=line><span class=cl><span class=cm>      */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nx>children</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>LevelContext.Provider</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>section</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><blockquote><p>Outsourcing <code>context</code> and <code>state</code> into a separate Provider component is a common pattern</p></blockquote></li></ul></li><li><p>Consume the context</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// Heading.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>useContext</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>LevelContext</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;./LevelContext.js&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>Heading</span><span class=p>({</span> <span class=nx>children</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>level</span> <span class=o>=</span> <span class=nx>useContext</span><span class=p>(</span><span class=nx>LevelContext</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// `useContext` tells React that the `Heading`component wants to
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// read the `LevelContext`
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// App.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>&lt;</span><span class=nt>Section</span> <span class=na>level</span><span class=o>=</span><span class=p>{</span><span class=mi>4</span><span class=p>}&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>Heading</span><span class=p>&gt;</span><span class=nx>Sub</span><span class=o>-</span><span class=nx>sub</span><span class=o>-</span><span class=nx>heading</span><span class=p>&lt;/</span><span class=nt>Heading</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>Heading</span><span class=p>&gt;</span><span class=nx>Sub</span><span class=o>-</span><span class=nx>sub</span><span class=o>-</span><span class=nx>heading</span><span class=p>&lt;/</span><span class=nt>Heading</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>Heading</span><span class=p>&gt;</span><span class=nx>Sub</span><span class=o>-</span><span class=nx>sub</span><span class=o>-</span><span class=nx>heading</span><span class=p>&lt;/</span><span class=nt>Heading</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Section</span><span class=p>&gt;</span>
</span></span></code></pre></div><ul><li><p>React will re-execute the component function if the context value changes</p><blockquote><p>You can also outsource <code>useContext(LevelContext)</code> into the Provider component</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// LevelContext.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=kd>function</span> <span class=nx>useLevel</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>useContext</span><span class=p>(</span><span class=nx>LevelContext</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Heading.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>useLevel</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;./LevelContext.js&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>level</span> <span class=o>=</span> <span class=nx>useContext</span><span class=p>();</span>
</span></span></code></pre></div></blockquote></li></ul></li></ol></li><li><p><strong>Context lets you write components that ‚Äúadapt to their surroundings‚Äù and display themselves differently depending on <em>where</em> (or, in other words, <em>in which context</em>) they are being rendered</strong></p></li><li><p>In React, the only way to override some context coming from above is to wrap children into a context provider with a different value</p></li><li><p>Different React contexts don&rsquo;t override each other</p></li><li><p>One component may use or provide many different contexts without a problem</p></li><li><p><strong>Use case for <code>context</code></strong></p><ul><li><strong>Theming:</strong> If your app lets the user change its appearance (e.g. dark mode), you can put a context provider at the top of your app, and use that context in components that need to adjust their visual look</li><li><strong>Current account:</strong> Many components might need to know the currently logged in user. Putting it in context makes it convenient to read it anywhere in the tree. Some apps also let you operate multiple accounts at the same time (e.g. to leave a comment as a different user). In those cases, it can be convenient to wrap a part of the UI into a nested provider with a different current account value</li><li><strong>Routing:</strong> Most routing solutions use context internally to hold the current route. This is how every link ‚Äúknows‚Äù whether it‚Äôs active or not. If you build your own router, you might want to do it too</li><li><strong>Managing state:</strong> As your app grows, you might end up with a lot of state closer to the top of your app. Many distant components below may want to change it. It is common to <a href=https://react.dev/learn/scaling-up-with-reducer-and-context>use a reducer together with context</a> to manage complex state and pass it down to distant components without too much hassle</li></ul></li></ul></li></ul><h3 id=reducer>Reducer<a hidden class=anchor aria-hidden=true href=#reducer>#</a></h3><ul><li><p>A reducer in React or JavaScript programming is a function that reduce one or more complex values to a simpler one</p></li><li><p>You can consolidate <em>state update logic</em> with a reducer outside your component in a single function, called <code>reducer</code></p></li><li><p>How to use Reducer</p><ol><li><p>Move from setting <code>state</code> to dispatch <code>actions</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// From this
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>handleAddTask</span><span class=p>(</span><span class=nx>text</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>setTasks</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span><span class=nx>tasks</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>id</span><span class=o>:</span> <span class=nx>nextId</span><span class=o>++</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>text</span><span class=o>:</span> <span class=nx>text</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>done</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>handleChangeTask</span><span class=p>(</span><span class=nx>task</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>setTasks</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>tasks</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>t</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>t</span><span class=p>.</span><span class=nx>id</span> <span class=o>===</span> <span class=nx>task</span><span class=p>.</span><span class=nx>id</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>task</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>t</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>handleDeleteTask</span><span class=p>(</span><span class=nx>taskId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>setTasks</span><span class=p>(</span><span class=nx>tasks</span><span class=p>.</span><span class=nx>filter</span><span class=p>((</span><span class=nx>t</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>t</span><span class=p>.</span><span class=nx>id</span> <span class=o>!==</span> <span class=nx>taskId</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// To this
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>handleAddTask</span><span class=p>(</span><span class=nx>text</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>dispatch</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=c1>// &#34;action&#34; object
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;ADD&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>payload</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>id</span><span class=o>:</span> <span class=nx>nextId</span><span class=o>++</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      	<span class=nx>text</span><span class=o>:</span> <span class=nx>text</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>  	<span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>handleChangeTask</span><span class=p>(</span><span class=nx>task</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>dispatch</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;CHANGE&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>payload</span><span class=o>:</span> <span class=nx>task</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>handleDeleteTask</span><span class=p>(</span><span class=nx>taskId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>dispatch</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;DELETE&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>payload</span><span class=o>:</span> <span class=nx>taskId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>An action object can have any shapes, by convention it&rsquo;s common to give a string <code>type</code> that describes what happened, and pass any additional information in an object <code>payload</code></li></ul></li><li><p>Write a reducer function</p><ol><li>Declare the current <code>state</code> as the first argument</li><li>Declare the <code>action</code> object as the second argument</li><li>Return the next <code>state</code> from the reducer</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kd>function</span> <span class=nx>yourReducer</span><span class=p>(</span><span class=nx>state</span><span class=p>,</span> <span class=nx>action</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// return next state for React to set
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kd>function</span> <span class=nx>tasksReducer</span><span class=p>(</span><span class=nx>tasks</span><span class=p>,</span> <span class=nx>action</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>switch</span> <span class=p>(</span><span class=nx>action</span><span class=p>.</span><span class=nx>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s1>&#39;ADD&#39;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>...</span><span class=nx>tasks</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>id</span><span class=o>:</span> <span class=nx>action</span><span class=p>.</span><span class=nx>payload</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>text</span><span class=o>:</span> <span class=nx>action</span><span class=p>.</span><span class=nx>payload</span><span class=p>.</span><span class=nx>text</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>done</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s1>&#39;CHANGE&#39;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>tasks</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>t</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>t</span><span class=p>.</span><span class=nx>id</span> <span class=o>===</span> <span class=nx>action</span><span class=p>.</span><span class=nx>payload</span><span class=p>.</span><span class=nx>id</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=nx>action</span><span class=p>.</span><span class=nx>payload</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=nx>t</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s1>&#39;DELETE&#39;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>tasks</span><span class=p>.</span><span class=nx>filter</span><span class=p>((</span><span class=nx>t</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>t</span><span class=p>.</span><span class=nx>id</span> <span class=o>!==</span> <span class=nx>action</span><span class=p>.</span><span class=nx>payload</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Unknown action: &#39;</span> <span class=o>+</span> <span class=nx>action</span><span class=p>.</span><span class=nx>type</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>It is recommend wrapping each <code>case</code> block into the <code>{</code> and <code>}</code> curly braces so that variables declared inside of different <code>case</code> don‚Äôt clash with each other</li><li>Reducer function is declared <strong>outside the component function</strong> so that it won&rsquo;t be re-created every time the component gets updated</li></ul></li><li><p>Use the reducer from your component</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span><span class=nx>useReducer</span><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// From this
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=p>[</span><span class=nx>tasks</span><span class=p>,</span> <span class=nx>setTasks</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=nx>initialTasks</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// To this
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=p>[</span><span class=nx>tasks</span><span class=p>,</span> <span class=nx>dispatch</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useReducer</span><span class=p>(</span><span class=nx>tasksReducer</span><span class=p>,</span> <span class=nx>initialTasks</span><span class=p>);</span>
</span></span></code></pre></div><ul><li>The <code>useReducer()</code> Hook takes two arguments:<ol><li>A reducer function</li><li>An initial state</li></ol></li><li>And it returns:<ol><li>A stateful value</li><li>A dispatch function (to ‚Äúdispatch‚Äù user actions to the reducer)</li></ol></li><li>If you want, you can even move the reducer to a different file</li></ul></li></ol></li><li><p><strong>Reducer must be pure</strong></p></li><li><p>Each action describes a single user interaction, even if that leads to multiple changes in the data</p></li><li><p>Writing concise reducer with <code>immer</code></p><ul><li><code>useImmerReducer</code></li><li>Reducers managed by <code>useImmerReducer</code> can mutate their first argument <code>state</code> and don‚Äôt need to return the new state (<strong>remember to <code>break</code></strong>)</li></ul></li></ul><hr><h2 id=refs><code>refs</code><a hidden class=anchor aria-hidden=true href=#refs>#</a></h2><h3 id=what-is-refs>What is <code>refs</code><a hidden class=anchor aria-hidden=true href=#what-is-refs>#</a></h3><ul><li><p>When you want a component to store some information, but you don&rsquo;t want to that information to trigger new renders, you can use a <code>ref</code></p></li><li><p>Adding a <code>ref</code> to your component</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useRef</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>ref</span> <span class=o>=</span> <span class=nx>useRef</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// useRef returns an object like this:
</span></span></span><span class=line><span class=cl><span class=c1>// { current: 0 }
</span></span></span></code></pre></div></li><li><p>You can mutate <code>ref</code> instead of using a set function, just change the value of <code>ref.current</code></p></li><li><p><strong><code>ref</code> is mutable; <code>state</code> is immutable</strong></p></li><li><p>When to use <code>refs</code></p><ul><li>Storing <code>timeout</code> IDs</li><li>Storing and manipulating DOM elements</li><li>Storing other objects that aren&rsquo;t necessary to calculate the JSX</li></ul></li></ul><h3 id=manipulating-dom-with-refs>Manipulating DOM with <code>refs</code><a hidden class=anchor aria-hidden=true href=#manipulating-dom-with-refs>#</a></h3><ul><li><p>DOM manipulation is the most common use case for <code>refs</code></p></li><li><p>Getting a <code>ref</code> to the node</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>const</span> <span class=nx>myRef</span> <span class=o>=</span> <span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>myRef</span><span class=p>}&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>myRef</span><span class=p>.</span><span class=nx>current</span><span class=p>.</span><span class=nx>scrollIntoView</span><span class=p>();</span>
</span></span></code></pre></div></li><li><p><strong>Accessing another component&rsquo;s DOM nodes</strong></p><ul><li><p>By default. React does not let a component access the DOM nodes of other components</p></li><li><p>A component can specify that it &ldquo;forwards&rdquo; its <code>ref</code> to one of <strong>its children</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MyInput</span> <span class=o>=</span> <span class=nx>forwardRef</span><span class=p>((</span><span class=nx>props</span><span class=p>,</span> <span class=nx>ref</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>input</span> <span class=p>{</span><span class=na>...props</span><span class=p>}</span> <span class=na>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>ref</span><span class=p>}</span> <span class=p>/&gt;;</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><ul><li><code>&lt;MyInput ref={inputRef} /></code> tells React to put the corresponding DOM node into <code>inputRef.current</code>. However, it‚Äôs up to the <code>MyInput</code> component to opt into that‚Äîby default, it doesn‚Äôt</li><li>The <code>MyInput</code> component is declared using <code>forwardRef()</code>. <strong>This opts it into receiving the <code>inputRef</code> from above as the second <code>ref</code> argument</strong> which is declared after <code>props</code></li><li><code>MyInput</code> itself passes the <code>ref</code> it received to the <code>&lt;input></code> inside of it</li></ul><blockquote><p>In design systems, it is a common pattern for low-level components like buttons, inputs, and so on, to forward their refs to their DOM nodes</p></blockquote></li></ul></li><li><p>You can expose component APIs via <a href=https://react.dev/reference/react/useImperativeHandle><code>useImperativeHandle()</code></a></p></li><li><p>Avoid changing DOM nodes managed by React</p></li></ul><hr><h2 id=dealing-with-effects>Dealing with <code>Effects</code><a hidden class=anchor aria-hidden=true href=#dealing-with-effects>#</a></h2><h3 id=what-is-effects>What is <code>Effects</code><a hidden class=anchor aria-hidden=true href=#what-is-effects>#</a></h3><ul><li><p>Two types of logic inside React components</p><ul><li><strong>Rendering code</strong><ul><li>Where you take the <code>props</code> and <code>state</code>, transform them, and return the JSX you want to see on the screen</li><li>Renderer must be pure</li></ul></li><li><strong>Event handlers</strong><ul><li>Nested functions inside your components that do things rather than just calculate them</li><li>Event handlers contain <a href=https://en.wikipedia.org/wiki/Side_effect_(computer_science)>‚Äúside effects‚Äù</a> (they change the program‚Äôs state) caused by a specific user action</li></ul></li></ul></li><li><p>Sometimes it isn&rsquo;t enough</p></li><li><p><code>effects</code> let you specify side effects are <strong>caused by rendering itself, or parent components&rsquo; <code>state</code> change (<em>which is, essentially, re-rendering itself</em>), rather than by a particular event</strong></p><blockquote><p><em>For example, a <code>state</code> change in the event handler of a component can cause some side effects that need to be handled in the <code>useEffect</code> inside the child component</em></p></blockquote></li><li><p><code>effects</code> run <strong>at the end of a <a href=#render-and-commit>commit</a> after the screen updates</strong>. This is a good time to synchronize the React components with some <strong>external system</strong> (like network or a third-party library or browser APIs)</p></li></ul><h3 id=effects--dependencies><code>effects</code> & <code>dependencies</code><a hidden class=anchor aria-hidden=true href=#effects--dependencies>#</a></h3><ul><li><p>How to write an <code>effect</code></p><ol><li><p>Declare an <code>effect</code></p><ul><li>By default, your <code>effect</code> will run every render</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Code here will run
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span></code></pre></div></li><li><p>Specify the <code>dependencies</code></p><ul><li>Most <code>effects</code> should only re-run when needed rather than after every render</li><li>You can tell React to skip unnecessary re-running the <code>effect</code> by specifying an <strong>array</strong> of <code>dependencies</code> as the second argument to the <code>useEffect</code> call</li><li>The <code>dependencies</code> array can contain multiple dependencies. <strong>React will only skip re-running the <code>effect</code> if <em>all</em> of the dependencies you specify have exactly the same values as they had during the previous render</strong></li><li>You can&rsquo;t &ldquo;choose&rdquo; your dependencies, linter does</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// This runs after every render
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// This runs only on mount (when the component appears)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>},</span> <span class=p>[]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// This runs on mount and also if either a or b have changed since the last render
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>},</span> <span class=p>[</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>]);</span>
</span></span></code></pre></div><ul><li>React compares the dependency values using the <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is><code>Object.is</code></a> comparison</li><li>The problem with object or function dependencies: infinite loop<ul><li><code>effect</code> execute even if the dependencies are logically equivalent (<em>with different pointers</em>)</li><li><a href=https://react.dev/reference/react/useCallback><strong><code>useCallback()</code></strong></a> to solve this problem<ul><li>Cache the function definition between re-renders</li></ul></li><li>Or, try to avoid them</li></ul></li><li>Mutable values (including global variables) aren‚Äôt reactive, so they shouldn&rsquo;t be dependencies<ul><li>A mutable value like <code>location.pathname</code> can‚Äôt be a dependency</li><li>A mutable value like <code>ref.current</code> or things you read from it also can‚Äôt be a dependency</li><li><code>ref</code> can be listed in dependencies but no point to do it because it&rsquo;s never changed</li></ul></li></ul></li><li><p>Add cleanup if needed</p><ul><li>Some <code>effects</code> need to specify how to stop, undo, or clean up whatever they were doing</li><li>Return a cleanup function from your <code>useEffect()</code></li><li>React will call your cleanup function <strong>each time before the <code>useEffect()</code> runs again</strong>, and one final time when <strong>the component unmounts</strong></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl>  <span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>connection</span> <span class=o>=</span> <span class=nx>createConnection</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>connection</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>connection</span><span class=p>.</span><span class=nx>disconnect</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>[]);</span>
</span></span></code></pre></div></li></ol></li><li><p>A potential problem with <code>effects</code> and <code>setState</code>: an infinte loop</p><ul><li><code>effect</code> execute after rendering, <code>setState</code> inside <code>effect</code> re-trigger the rendering</li><li>Solution: remove <code>state</code> from dependencies and pass updater function to <code>setState</code> in <code>useEffect()</code></li></ul></li><li><p>React will remount the <code>effects</code> whenever you save a file in development</p></li></ul><h3 id=when-not-to-use-useeffect>When NOT to use <code>useEffect()</code><a hidden class=anchor aria-hidden=true href=#when-not-to-use-useeffect>#</a></h3><ul><li>Some logic should only run once when the application starts. You can put it outside your components<ul><li><strong>Those codes wil execute once the first time the file is imported</strong></li></ul></li><li>Updating state based on <code>props</code> and <code>state</code><ul><li>Calculate the value inside the component</li></ul></li><li><a href=https://react.dev/learn/you-might-not-need-an-effect#initializing-the-application>Etc.</a></li></ul><hr><h2 id=react-hooks>React Hooks<a hidden class=anchor aria-hidden=true href=#react-hooks>#</a></h2><ul><li><strong>Hooks are functions that let you &ldquo;hook into&rdquo; React state and features from function components</strong></li><li>Functions starting with <code>use</code></li><li>Can only be called at the top level of your components or your own Hooks</li><li>Can only call Hooks on the top level</li></ul><h3 id=usecallbackhttpsreactdevreferencereactusecallback><a href=https://react.dev/reference/react/useCallback><code>useCallback()</code></a><a hidden class=anchor aria-hidden=true href=#usecallbackhttpsreactdevreferencereactusecallback>#</a></h3><ul><li><p>Let you cache a function definition between re-renders</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cachedFn</span> <span class=o>=</span> <span class=nx>useCallback</span><span class=p>(</span><span class=nx>fn</span><span class=p>,</span> <span class=nx>dependencies</span><span class=p>);</span>
</span></span></code></pre></div></li><li><p>Return</p><ul><li>On the initial render, <code>useCallback</code> returns the <code>fn</code> function you have passed</li><li>During subsequent renders, it will either return an already stored <code>fn</code> function from the last render (if the dependencies haven‚Äôt changed), or return the <code>fn</code> function you have passed during this render</li></ul></li><li><p>Usage</p><ul><li>You pass it as a prop to a component wrapped in <code>memo()</code>. You want to skip re-rendering if the value hasn‚Äôt changed. Memoization lets your component re-render only if dependencies changed</li><li>The function you‚Äôre passing is later used as a dependency of some Hook. For example, another function wrapped in <code>useCallback()</code> depends on it, or you depend on this function from <code>useEffect()</code></li></ul></li></ul><h3 id=usememohttpsreactdevreferencereactusememo><a href=https://react.dev/reference/react/useMemo><code>useMemo()</code></a><a hidden class=anchor aria-hidden=true href=#usememohttpsreactdevreferencereactusememo>#</a></h3><ul><li><p>Let you cache the result of a calculation between re-renders</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cachedValue</span> <span class=o>=</span> <span class=nx>useMemo</span><span class=p>(</span><span class=nx>calcValue</span><span class=p>,</span> <span class=nx>dependencies</span><span class=p>);</span>
</span></span></code></pre></div></li><li><p>Parameters</p><ul><li><code>calculateValue</code>: <strong>The function calculating the value</strong> that you want to cache. It should be pure, should take no arguments, and should return a value of any type. React will call your function during the initial render. On next renders, React will return the same value again if the <code>dependencies</code> have not changed since the last render. Otherwise, it will call <code>calculateValue</code>, return its result, and store it so it can be reused later</li></ul></li><li><p>Return</p><ul><li>On the initial render, <code>useMemo</code> returns the result of calling <code>calculateValue</code> with no arguments</li><li>During next renders, it will either return an already stored value from the last render (if the dependencies haven‚Äôt changed), or call <code>calculateValue</code> again, and return the result that <code>calculateValue</code> has returned</li></ul></li><li><p>Usage</p><ul><li><strong>You should only rely on <code>useMemo()</code> as a performance optimization</strong></li><li>Skipping expensive recalculations</li></ul></li></ul><h3 id=custom-hooks>Custom Hooks<a hidden class=anchor aria-hidden=true href=#custom-hooks>#</a></h3><ul><li><p>Share logic between components</p></li><li><p>Hook names always start with <code>use</code></p></li><li><p>Custom hooks let you share stateful logic, not <code>state</code> itself; each call to a Hook is completely independent from every other call to the same Hook</p></li><li><p>When to use custom hook</p><ul><li><p>With time, most of your app&rsquo;s <code>effect</code> will be in custom Hooks</p><ul><li>You make the data flow to and from your Effects very explicit</li><li>You let your components focus on the intent rather than on the exact implementation of your Effects</li><li>When React adds new features, you can remove those Effects without changing any of your components</li></ul></li><li><p>Keep custom Hooks focused on concrete high-level use cases</p></li><li><p>A good custom Hook makes the calling code more declarative by constraining what it does</p></li></ul></li></ul><hr><h2 id=debugging-react-apps>Debugging React Apps<a hidden class=anchor aria-hidden=true href=#debugging-react-apps>#</a></h2><ul><li>Error messages</li><li>Browser debugger</li><li>&ldquo;strict mode&rdquo;<ul><li>A React component <code>StrictMode</code> as an wrapper for other components</li></ul></li><li>React DevTools</li></ul><hr><h2 id=class-based-components>Class-Based Components<a hidden class=anchor aria-hidden=true href=#class-based-components>#</a></h2><h3 id=what--why>What & Why<a hidden class=anchor aria-hidden=true href=#what--why>#</a></h3><ul><li>Functional component is the default and most modern approach</li><li>Traditionally, which means before React 16.8, you had to use class-based components to manage <code>state</code></li><li>React 16.8 introduced <em>React Hooks</em> for functional components</li><li>Class-based components <strong>CAN&rsquo;T</strong> use React Hooks</li></ul><h3 id=working-with-class-based-components>Working with Class-Based Components<a hidden class=anchor aria-hidden=true href=#working-with-class-based-components>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Component</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>class</span> <span class=nx>User</span> <span class=kr>extends</span> <span class=nx>Component</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>static</span> <span class=nx>contextType</span> <span class=o>=</span> <span class=nx>UsersContext</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// pitfall: can only link to one context
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>super</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// For class-based component, state is always an object
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// And it also has to be a property named &#34;state&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>state</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>showUsers</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>more</span><span class=o>:</span> <span class=s2>&#34;test&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>toggleUsersHandler</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// React will merge the new state object with the old one
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// this.setState({showUsers: false});
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>setStae</span><span class=p>((</span><span class=nx>curState</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span><span class=k>return</span> <span class=p>{</span><span class=nx>showUsers</span><span class=o>:</span> <span class=o>!</span><span class=nx>curState</span><span class=p>.</span><span class=nx>showUsers</span><span class=p>};});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>usersList</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      	<span class=p>{</span><span class=k>this</span><span class=p>.</span><span class=nx>context</span><span class=p>.</span><span class=nx>users</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>user</span> <span class=p>=&gt;</span> <span class=p>&lt;</span><span class=nt>User</span> <span class=na>key</span><span class=o>=</span><span class=p>{</span><span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>}</span> <span class=na>name</span><span class=o>=</span><span class=p>{</span><span class=nx>user</span><span class=p>.</span><span class=nx>name</span><span class=p>}</span> <span class=p>/&gt;)}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>div</span> <span class=na>className</span><span class=o>=</span><span class=p>{</span><span class=nx>classes</span><span class=p>.</span><span class=nx>user</span><span class=p>}&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{</span><span class=k>this</span><span class=p>.</span><span class=nx>toggleUsersHandler</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>)}&gt;</span>
</span></span><span class=line><span class=cl>        	<span class=p>{</span><span class=k>this</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>showUsers</span> <span class=o>?</span> <span class=s2>&#34;Hide&#34;</span> <span class=o>:</span> <span class=s2>&#34;Show&#34;</span><span class=p>}</span> <span class=nx>Users</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=k>this</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>showUsers</span> <span class=o>&amp;&amp;</span> <span class=nx>usersList</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  	<span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Component lifecycle methods
</span></span></span><span class=line><span class=cl><span class=c1>// A more imperative way, you have to add if block to specify when you want to skip the execution
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>componentDidMount</span><span class=p>()</span> <span class=o>===</span> <span class=nx>useEffect</span><span class=p>(</span><span class=nx>fn</span><span class=p>,</span> <span class=p>[]);</span>							<span class=c1>// Called once a component mounted
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>componentDidUpdate</span><span class=p>()</span> <span class=o>===</span> <span class=nx>useEffect</span><span class=p>(</span><span class=nx>fn</span><span class=p>,</span> <span class=p>[</span><span class=nx>someValue</span><span class=p>]);</span>		<span class=c1>// Called once a component updated
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>componentWillUnmount</span><span class=p>()</span> <span class=o>===</span> <span class=c1>//cleanup function						// Called once a component unmounted
</span></span></span></code></pre></div><h3 id=error-boundaries>Error Boundaries<a hidden class=anchor aria-hidden=true href=#error-boundaries>#</a></h3><ul><li><p>Right now (Nov 17 2023) this feature can only be used in class-based component</p></li><li><p>An error generated inside a component cannot be handled inside it, it should be treated as an information, and be catched and handled in the parent component</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Component</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Wrap this error handler component around components should be protected by it
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=k>default</span> <span class=kr>class</span> <span class=nx>ErrorBoundary</span> <span class=kr>extends</span> <span class=nx>Component</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>super</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>state</span> <span class=o>=</span> <span class=p>{</span><span class=nx>hasError</span><span class=o>:</span> <span class=kc>false</span><span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>componentDidCatch</span><span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>setState</span><span class=p>({</span><span class=nx>hasError</span><span class=o>:</span> <span class=kc>true</span><span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nx>hasError</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>Something</span> <span class=nx>went</span> <span class=nx>wrong</span><span class=o>!</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>.</span><span class=nx>children</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul><hr><h2 id=handling-http-request>Handling HTTP Request<a hidden class=anchor aria-hidden=true href=#handling-http-request>#</a></h2><h3 id=how-to-connect-a-back-end--database>How to Connect a Back-end / Database<a hidden class=anchor aria-hidden=true href=#how-to-connect-a-back-end--database>#</a></h3><ul><li>Not all operations can be performed in the browser<ul><li>Cannot connect to a database directly</li><li>Cannot access a file system</li><li>Etc.</li></ul></li><li>Browser &lt;-> Back Server &lt;-> Database via HTTP</li></ul><h3 id=fetching-data>Fetching Data<a hidden class=anchor aria-hidden=true href=#fetching-data>#</a></h3><ul><li><code>useEffect()</code> + <code>fetch()</code></li><li>Handle loading status</li><li>Handle HTTP errors</li><li>Outsource <code>AJAX(url, config, initialData)</code> helper function</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=kr>async</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>setIsFetching</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=s2>&#34;http://localhost:3000/places&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    	<span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nx>response</span><span class=p>.</span><span class=nx>ok</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      	<span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=sb>`üí• Failed to fetch data! </span><span class=si>${</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    	<span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=nx>setPlaces</span><span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>places</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>setError</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>setIsFetching</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>})();</span>
</span></span><span class=line><span class=cl><span class=p>},</span> <span class=p>[]);</span>
</span></span></code></pre></div><h3 id=sending-data>Sending Data<a hidden class=anchor aria-hidden=true href=#sending-data>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>export</span> <span class=kr>async</span> <span class=kd>function</span> <span class=nx>updateUserPlaces</span><span class=p>(</span><span class=nx>places</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=s2>&#34;http://localhost:3000/user-places&#34;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>method</span><span class=o>:</span> <span class=s2>&#34;PUT&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>body</span><span class=o>:</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span> <span class=nx>places</span> <span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;Content-Type&#34;</span><span class=o>:</span> <span class=s2>&#34;application/json&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nx>response</span><span class=p>.</span><span class=nx>ok</span><span class=p>)</span>	<span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s2>&#34;Failed to update user data!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>data</span><span class=p>.</span><span class=nx>message</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>Handler functions can be <code>async</code></li><li>Optimistic updating<ul><li>Change the UI immediately before sending data behind the screen</li><li>Rollback the change if HTTP request fail</li></ul></li></ul><hr><h2 id=working-with-forms--user-input>Working with Forms & User Input<a hidden class=anchor aria-hidden=true href=#working-with-forms--user-input>#</a></h2><h3 id=what-is-form>What is Form<a hidden class=anchor aria-hidden=true href=#what-is-form>#</a></h3><ul><li><a href=https://www.w3schools.com/html/html_forms.asp>HTML Forms</a></li><li>The <code>for</code> attribute of the <code>&lt;label></code> tag should be equal to the <code>id</code> attribute of the <code>&lt;input></code> element to bind them together<ul><li>In JSX it&rsquo;s named <code>htmlFor</code></li></ul></li><li>Each input field must have a <code>name</code> attribute to be submitted. If the <code>name</code> attribute is omitted, the value of the input field will not be sent at all</li><li>Validating user input is the trickier part</li></ul><h3 id=handling-form-submission>Handling Form Submission<a hidden class=anchor aria-hidden=true href=#handling-form-submission>#</a></h3><ul><li><p>Form submission</p><ul><li>By default, the browser sends a HTTP request to the server when a button inside <code>form</code> has been clicked; therefore, the page will reload</li><li>This can be a problem when there is no handler for this request on the server (React app)</li><li>Solution<ul><li><code>&lt;button type="button">&lt;/button></code></li><li>Refactor from <code>&lt;button onClick={handler}>&lt;/button></code> to <code>&lt;form onSubmit={handler}>&lt;/form></code> + <code>e.preventDefault()</code><ul><li>Suggested way</li></ul></li></ul></li></ul></li><li><p>Getting user input via <code>state</code></p><ul><li>Two-way binding for updating inputs: <code>onChange={handler}</code> + <code>setState(e.targer.value)</code></li><li>Make it generic by creating object <code>state</code> and refactoring to one handler <code>handlerInputChange(identifier, e)</code></li></ul></li><li><p>Getting user input via <code>ref</code></p><ul><li>Link <code>refs</code> to <code>input</code> elements</li><li>Have to use <code>ref</code> to manipulate DOM directly which is not recommended</li><li>Cannot bundle <code>refs</code> into one object</li></ul></li><li><p>Getting user input via <code>FormData</code> & native Browser APIs</p><ul><li>Useful for handling form that has lots of inputs</li><li>Example</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kd>function</span> <span class=nx>handleSubmit</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>e</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>fd</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>FormData</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>acquisition</span> <span class=o>=</span> <span class=nx>fd</span><span class=p>.</span><span class=nx>getAll</span><span class=p>(</span><span class=s2>&#34;acquisition&#34;</span><span class=p>);</span>			<span class=c1>// get all values asscoiated with a given input name
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>fromEntries</span><span class=p>(</span><span class=nx>fd</span><span class=p>.</span><span class=nx>entries</span><span class=p>());</span>
</span></span><span class=line><span class=cl>  <span class=nx>data</span><span class=p>.</span><span class=nx>acquisition</span> <span class=o>=</span> <span class=nx>acquisition</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li><li><p>Resetting Form</p><ul><li><code>&lt;button type="reset">Reset&lt;/button></code>; or,</li><li>Reset <code>state</code>; or,</li><li><code>ref.current.value = ""</code>; or,</li><li><code>e.target.reset()</code><ul><li><code>e.target</code> is the form element</li></ul></li></ul></li></ul><h3 id=validating-user-input>Validating User Input<a hidden class=anchor aria-hidden=true href=#validating-user-input>#</a></h3><ul><li><p>Compute the <code>isValid</code> logic and render conditionally</p></li><li><p>Always add <code>onSubmit</code> validation</p></li><li><p>Validating input on every key stoke via <code>state</code></p><ul><li>Errors may be shown too early</li></ul></li><li><p>Validating input upon lost focus</p><ul><li><code>OnBlue={handleInputBlur}</code></li><li>Errors may not disappear when the user starts to type again</li></ul><blockquote><p>Combining validating on key stoke and lost focus is a good pattern</p></blockquote></li><li><p>Validating input upon form submission</p></li><li><p>Validating input via built-in validation <code>props</code></p><ul><li><code>type</code>, <code>required</code>, etc.</li></ul><blockquote><p>Combining custom and built-in validation logic is also a good pattern</p></blockquote></li></ul><h3 id=building-custom-solutions>Building Custom Solutions<a hidden class=anchor aria-hidden=true href=#building-custom-solutions>#</a></h3><ul><li>Custom <code>Input</code> Component</li><li>Custom <code>useInput</code> Hook</li><li>Outsource validation logic</li><li>Use third-party form libraries</li></ul><hr><h2 id=redux>Redux<a hidden class=anchor aria-hidden=true href=#redux>#</a></h2><h3 id=what-is-redux>What is Redux<a hidden class=anchor aria-hidden=true href=#what-is-redux>#</a></h3><ul><li><p>Redux is a state management system for <em>cross-component</em> or <em>app-wide</em> state</p></li><li><p>Redux can be used anywhere without React</p></li><li><p>Core concept of Redux</p><p><img loading=lazy src=../imgs/Redux-Concept.png alt=Redux-Concept></p></li><li><p>Redux Toolkit</p><ul><li><p><a href=https://redux-toolkit.js.org/><strong>Redux Toolkit</strong></a> (also known as <strong>&ldquo;RTK&rdquo;</strong> for short) is our official recommended approach for writing Redux logic</p></li><li><p>The <code>@reduxjs/toolkit</code> package wraps around the core <code>redux</code> package, and contains API methods and common dependencies that are essential for building a Redux app</p></li><li><p><strong>If you are writing any Redux logic today, you should be using Redux Toolkit to write that code!</strong></p></li></ul></li></ul><h3 id=why-using-redux>Why using Redux<a hidden class=anchor aria-hidden=true href=#why-using-redux>#</a></h3><ul><li>Potential problems of <code>context</code><ul><li>Deeply nested components</li><li>Complex providers</li><li>Performance issue from high-frequency changes</li></ul></li><li><strong>Redux is most useful in cases when</strong>:<ul><li>You have large amounts of application state that are needed in many places in the app</li><li>The app state is updated frequently</li><li>The logic to update that state may be complex</li><li>The app has a medium or large-sized codebase, and might be worked on by many people</li><li>You need to see how that state is being updated over time</li></ul></li><li><a href=https://changelog.com/posts/when-and-when-not-to-reach-for-redux>When(and when not) to reach for Redux by Mark Erikson</a></li><li>In a nutshell, use the tool when you need it</li></ul><h3 id=how-to-use-redux>How to use Redux<a hidden class=anchor aria-hidden=true href=#how-to-use-redux>#</a></h3><h4 id=redux-core>Redux Core<a hidden class=anchor aria-hidden=true href=#redux-core>#</a></h4><ul><li><p><strong>Store</strong></p><ul><li><p>The current Redux application state lives in an object called <strong>store</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>redux</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;redux&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=nx>redux</span><span class=p>.</span><span class=nx>createStore</span><span class=p>(</span><span class=nx>counterReducer</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>store</span><span class=p>.</span><span class=nx>getState</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=c1>// {value: 0}
</span></span></span></code></pre></div></li></ul></li><li><p><strong>Subscriber</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>const</span> <span class=nx>state</span> <span class=o>=</span> <span class=nx>store</span><span class=p>.</span><span class=nx>getState</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>store</span><span class=p>.</span><span class=nx>subscribe</span><span class=p>(</span><span class=nx>render</span><span class=p>);</span>
</span></span></code></pre></div></li><li><p><strong>Selector</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>const</span> <span class=nx>selectCounterValue</span> <span class=o>=</span> <span class=nx>state</span> <span class=p>=&gt;</span> <span class=nx>state</span><span class=p>.</span><span class=nx>value</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>currentValue</span> <span class=o>=</span> <span class=nx>selectCounterValue</span><span class=p>(</span><span class=nx>store</span><span class=p>.</span><span class=nx>getState</span><span class=p>())</span>
</span></span></code></pre></div></li><li><p><strong>Dispatch</strong></p><ul><li><p>The Redux <code>store</code> has a method called <code>dispatch</code></p></li><li><p><strong>The only way to update the <code>state</code> is to call store.dispatch(action)</strong></p></li><li><p>The <code>store</code> will run its <code>slice reducer</code> function and save the new <code>state</code> value inside</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=nx>store</span><span class=p>.</span><span class=nx>dispatch</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;counter/increment&#39;</span> <span class=p>})</span>
</span></span></code></pre></div></li><li><p>Typically we call <code>actionCreator</code> to dispatch the right <code>action</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>const</span> <span class=nx>increment</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;counter/increment&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>store</span><span class=p>.</span><span class=nx>dispatch</span><span class=p>(</span><span class=nx>increment</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>store</span><span class=p>.</span><span class=nx>getState</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=c1>// {value: 1}
</span></span></span></code></pre></div></li></ul></li><li><p><strong>Reducer</strong></p><ul><li><p>Reducer is a function that receives the current <code>state</code> and an <code>action</code> object, decide how to update the <code>state</code> id necessary, and return the new <code>state</code></p></li><li><p><strong>You can think of a <code>reducer</code> as an event listener which handles events based on the received action (event) type</strong></p></li><li><p>Reducer should be a <strong>pure function</strong></p><ul><li>They must not do any asynchronous logic, calculate random values, or cause other &ldquo;side effects&rdquo;</li></ul></li><li><p>State should be <strong>immutable</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>const</span> <span class=nx>initialState</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>value</span><span class=o>:</span> <span class=mi>0</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>counterReducer</span><span class=p>(</span><span class=nx>state</span> <span class=o>=</span> <span class=nx>initialState</span><span class=p>,</span> <span class=nx>action</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Check to see if the reducer cares about this action
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>action</span><span class=p>.</span><span class=nx>type</span> <span class=o>===</span> <span class=s1>&#39;counter/increment&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// If so, make a copy of `state`
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=p>...</span><span class=nx>state</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=c1>// and update the copy with the new value
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>value</span><span class=o>:</span> <span class=nx>state</span><span class=p>.</span><span class=nx>value</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// otherwise return the existing state unchanged
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=nx>state</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul></li><li><p><strong>Action</strong></p><ul><li><p>An <code>action</code> is a plain JavaScript object that has a <code>type</code> field</p></li><li><p><strong>You can think of an action as an event that describes something that happened in the application</strong></p></li><li><p>The <code>type</code> field should be a string that gives this action a descriptive name. We usually write that type string like <code>"domain/eventName"</code>, where the first part is the feature or category that this action belongs to, and the second part is the specific thing that happened</p></li><li><p>An action object can have other fields with additional information about what happened. By convention, we put that information in a field called <code>payload</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>const</span> <span class=nx>addTodoAction</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;todos/todoAdded&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>payload</span><span class=o>:</span> <span class=s1>&#39;Buy milk&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul></li><li><p><strong>Action Creators</strong></p><ul><li><p>An action creator is a function that creates and return <code>action</code> object</p></li><li><p>It is typically used so we don&rsquo;t have to write the <code>action</code> object by hand everytime</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=kr>const</span> <span class=nx>addTodo</span> <span class=o>=</span> <span class=nx>text</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;todos/todoAdded&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>payload</span><span class=o>:</span> <span class=nx>text</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul></li></ul><h4 id=react-redux-application-contents-modern-way><strong>React-Redux Application Contents (Modern way)</strong><a hidden class=anchor aria-hidden=true href=#react-redux-application-contents-modern-way>#</a></h4><ul><li>Redux allows <code>store</code> setup to be customised with different plugins (<code>middleware</code> and <code>enhancers</code>)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// store.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>configureStore</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@reduxjs/toolkit&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>counterReducer</span> <span class=nx>from</span> <span class=s1>&#39;../features/counter/counterSlice&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>configureStore</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=c1>// root reducer
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>reducer</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// slice reducer
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>counter</span><span class=o>:</span> <span class=nx>counterReducer</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=c1>// When we pass in an object like {counter: counterReducer}, that says that
</span></span></span><span class=line><span class=cl><span class=c1>// we want to have a state.counter section of our Redux state object, and that
</span></span></span><span class=line><span class=cl><span class=c1>// we want the counterReducer function to be in charge of deciding if and
</span></span></span><span class=line><span class=cl><span class=c1>// how to update the state.counter section whenever an action is dispatched.
</span></span></span></code></pre></div><ul><li><strong>A &ldquo;redux slice&rdquo; is a collection of Redux reducer logic and actions for a single feature in your app</strong>, typically defined together in a single file. The name comes from splitting up the root Redux state object into multiple &ldquo;slices&rdquo; of state</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// counterSlice.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>createSlice</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@reduxjs/toolkit&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>counterSlice</span> <span class=o>=</span> <span class=nx>createSlice</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;counter&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>initialState</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>value</span><span class=o>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>reducers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>increment</span><span class=o>:</span> <span class=nx>state</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// Redux Toolkit allows us to write &#34;mutating&#34; logic in reducers. It
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// doesn&#39;t actually mutate the state because it uses the immer library,
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// which detects changes to a &#34;draft state&#34; and produces a brand new
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// immutable state based off those changes
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>state</span><span class=p>.</span><span class=nx>value</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>decrement</span><span class=o>:</span> <span class=nx>state</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>state</span><span class=p>.</span><span class=nx>value</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>incrementByAmount</span><span class=o>:</span> <span class=p>(</span><span class=nx>state</span><span class=p>,</span> <span class=nx>action</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>state</span><span class=p>.</span><span class=nx>value</span> <span class=o>+=</span> <span class=nx>action</span><span class=p>.</span><span class=nx>payload</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// action creators
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=kr>const</span> <span class=p>{</span> <span class=nx>increment</span><span class=p>,</span> <span class=nx>decrement</span><span class=p>,</span> <span class=nx>incrementByAmount</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>counterSlice</span><span class=p>.</span><span class=nx>actions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// reducer function
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=k>default</span> <span class=nx>counterSlice</span><span class=p>.</span><span class=nx>reducer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// selector
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=kr>const</span> <span class=nx>selectCount</span> <span class=o>=</span> <span class=nx>state</span> <span class=p>=&gt;</span> <span class=nx>state</span><span class=p>.</span><span class=nx>counter</span><span class=p>.</span><span class=nx>value</span>
</span></span></code></pre></div><ul><li>The <code>React-Redux</code> library has a set of custom Hooks that allow your React component to interact with a Redux <code>store</code></li><li>React components can&rsquo;t talk to the Redux <code>store</code> directly, because we&rsquo;re not allowed to import it into component files</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// Counter.jsx
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=nx>React</span><span class=p>,</span> <span class=p>{</span> <span class=nx>useState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useSelector</span><span class=p>,</span> <span class=nx>useDispatch</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react-redux&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>decrement</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>increment</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>incrementByAmount</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>incrementAsync</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>selectCount</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;./counterSlice&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>styles</span> <span class=nx>from</span> <span class=s1>&#39;./Counter.module.css&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kd>function</span> <span class=nx>Counter</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Reading data with useSelector
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=nx>useSelector</span><span class=p>(</span><span class=nx>selectCount</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Dispatch actions
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>dispatch</span> <span class=o>=</span> <span class=nx>useDispatch</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>incrementAmount</span><span class=p>,</span> <span class=nx>setIncrementAmount</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>div</span> <span class=na>className</span><span class=o>=</span><span class=p>{</span><span class=nx>styles</span><span class=p>.</span><span class=nx>row</span><span class=p>}&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span>
</span></span><span class=line><span class=cl>          <span class=na>className</span><span class=o>=</span><span class=p>{</span><span class=nx>styles</span><span class=p>.</span><span class=nx>button</span><span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=na>aria</span><span class=err>-</span><span class=na>label</span><span class=o>=</span><span class=s>&#34;Increment value&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>dispatch</span><span class=p>(</span><span class=nx>increment</span><span class=p>())}</span>
</span></span><span class=line><span class=cl>        <span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=o>+</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>span</span> <span class=na>className</span><span class=o>=</span><span class=p>{</span><span class=nx>styles</span><span class=p>.</span><span class=nx>value</span><span class=p>}&gt;{</span><span class=nx>count</span><span class=p>}&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span>
</span></span><span class=line><span class=cl>          <span class=na>className</span><span class=o>=</span><span class=p>{</span><span class=nx>styles</span><span class=p>.</span><span class=nx>button</span><span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=na>aria</span><span class=err>-</span><span class=na>label</span><span class=o>=</span><span class=s>&#34;Decrement value&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>dispatch</span><span class=p>(</span><span class=nx>decrement</span><span class=p>())}</span>
</span></span><span class=line><span class=cl>        <span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=o>-</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span>
</span></span><span class=line><span class=cl>          <span class=na>className</span><span class=o>=</span><span class=p>{</span><span class=nx>styles</span><span class=p>.</span><span class=nx>button</span><span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=na>aria</span><span class=err>-</span><span class=na>label</span><span class=o>=</span><span class=s>&#34;Increment value by amount&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>dispatch</span><span class=p>(</span><span class=nx>incrementByAmount</span><span class=p>(</span><span class=nx>incrementAmount</span><span class=p>))}</span>
</span></span><span class=line><span class=cl>        <span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=o>-</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* omit additional rendering output here */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>Providing the <code>store</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// index.js or main.jsx
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>ReactDOM</span> <span class=nx>from</span> <span class=s1>&#39;react-dom&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s1>&#39;./index.css&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>App</span> <span class=nx>from</span> <span class=s1>&#39;./App&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>store</span> <span class=nx>from</span> <span class=s1>&#39;./app/store&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Provider</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react-redux&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>ReactDOM</span><span class=p>.</span><span class=nx>render</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>Provider</span> <span class=na>store</span><span class=o>=</span><span class=p>{</span><span class=nx>store</span><span class=p>}&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>App</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>Provider</span><span class=p>&gt;,</span>
</span></span><span class=line><span class=cl>  <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;root&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><ul><li><p>Writing async logic</p><ul><li><p>Inside <code>useEffect()</code>, listening to <code>state</code> change</p><ul><li>A potential problem<ul><li><code>useEffect()</code> send the initial (i.e. empty) data to our backend and overwrite any data stored there</li><li>Use an if block to skip the first execution</li></ul></li></ul></li><li><p>Using <code>thunk</code></p><ul><li><code>thunk</code> is a programming term that means <em>&ldquo;a piece of code that does some delayed work&rdquo;</em></li><li>Using thunks requires the <code>redux-thunk</code> middleware to be added to the Redux store as part of its configuration</li><li><strong>A <code>thunk</code> function is a function that accept two arguments: Redux <code>store</code> <code>dispatch()</code> method and <code>getState()</code> method</strong></li><li><code>thunk</code> function are not directly called by application code, instead, they are passed to <code>store.dispatch()</code></li><li>We normally use custom action creator to generate <code>thunk</code> function</li><li>A <strong><code>thunk action creator</code></strong> is a function that may have some arguments, and returns a <code>thunk</code> function</li><li><strong><code>thunk</code> gives us a place to put side effects</strong></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// the outside &#34;thunk creator&#34; function
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>fetchUserById</span> <span class=o>=</span> <span class=nx>userId</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// the inside &#34;thunk function&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>dispatch</span><span class=p>,</span> <span class=nx>getState</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// make an async call in the thunk
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>userAPI</span><span class=p>.</span><span class=nx>fetchById</span><span class=p>(</span><span class=nx>userId</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=c1>// dispatch an action when we get the response back
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>dispatch</span><span class=p>(</span><span class=nx>userLoaded</span><span class=p>(</span><span class=nx>user</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// If something went wrong, handle it here
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// use arrow function
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=kr>const</span> <span class=nx>fetchUserById</span> <span class=o>=</span> <span class=nx>userId</span> <span class=p>=&gt;</span> <span class=kr>async</span> <span class=nx>dispatch</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>userAPI</span><span class=p>.</span><span class=nx>fetchById</span><span class=p>(</span><span class=nx>userId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>dispatch</span><span class=p>(</span><span class=nx>userLoaded</span><span class=p>(</span><span class=nx>user</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul></li></ul><h3 id=redux-application-data-flow>Redux Application Data Flow<a hidden class=anchor aria-hidden=true href=#redux-application-data-flow>#</a></h3><ul><li>Redux data flow is one-way</li><li>Initial setup:<ul><li>A Redux store is created using a root reducer function</li><li>The store calls the root reducer once, and saves the return value as its initial <code>state</code></li><li>When the UI is first rendered, UI components access the current state of the Redux store, and use that data to decide what to render. They also subscribe to any future store updates so they can know if the state has changed.</li></ul></li><li>Updates:<ul><li>Something happens in the app, such as a user clicking a button</li><li>The app code dispatches an action to the Redux store, like <code>dispatch({type: 'counter/increment'})</code></li><li>The store runs the reducer function again with the previous <code>state</code> and the current <code>action</code>, and saves the return value as the new <code>state</code></li><li>The store notifies all parts of the UI that are subscribed that the store has been updated</li><li>Each UI component that needs data from the store checks to see if the parts of the state they need have changed.</li><li>Each component that sees its data has changed forces a re-render with the new data, so it can update what&rsquo;s shown on the screen</li></ul></li></ul><hr><h2 id=react-router>React Router<a hidden class=anchor aria-hidden=true href=#react-router>#</a></h2><ul><li><p>Client-side code simply watches url changes and then loads different React components, instead of fetching new html files</p></li><li><p>Application content</p><ol><li><p><code>npm install react-router-dom</code></p></li><li><p>Adding a router</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// index.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=o>*</span> <span class=nx>as</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=o>*</span> <span class=nx>as</span> <span class=nx>ReactDOM</span> <span class=nx>from</span> <span class=s2>&#34;react-dom/client&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>createBrowserRouter</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>RouterProvider</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react-router-dom&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s2>&#34;./index.css&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>HomePage</span> <span class=nx>from</span> <span class=s1>&#39;./pages/Home&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>ProductsPage</span> <span class=nx>from</span> <span class=s1>&#39;./pages/Products&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createBrowserRouter</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span> <span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>HomePage</span> <span class=p>/&gt;,</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/products&#34;</span><span class=p>,</span> <span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>ProductsPage</span> <span class=p>/&gt;,</span> <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>ReactDOM</span><span class=p>.</span><span class=nx>createRoot</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;root&#34;</span><span class=p>)).</span><span class=nx>render</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>React.StrictMode</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>RouterProvider</span> <span class=na>router</span><span class=o>=</span><span class=p>{</span><span class=nx>router</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>React.StrictMode</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></div><ul><li>Due to the decoupling of fetching and rendering in the design of the data APIs, you should create your router outside of the React tree with a statically defined set of routes</li><li><a href=https://reactrouter.com/en/main/routers/create-browser-router><code>createBrowserRouter()</code></a></li></ul></li><li><p>Navigating between Pages with Links</p><ul><li>Prevent default behavior that sending request to the server and restart the React application</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// Home.jsx
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>Link</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react-router-dom&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// omitted
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>&lt;</span><span class=nt>Link</span> <span class=na>to</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;/products&#34;</span><span class=p>}&gt;</span><span class=nx>Products</span><span class=p>&lt;/</span><span class=nt>Link</span><span class=p>&gt;</span>
</span></span></code></pre></div><ul><li><p><a href=https://reactrouter.com/en/main/components/link>Link</a></p></li><li><p>Under the hood, <code>Link</code> renders a <code>&lt;a>&lt;/a></code> elememnt</p></li><li><p><a href=https://reactrouter.com/en/main/components/nav-link>NavLink</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>NavLink</span>
</span></span><span class=line><span class=cl>  <span class=na>to</span><span class=o>=</span><span class=s>&#34;/messages&#34;</span>
</span></span><span class=line><span class=cl>  <span class=na>className</span><span class=o>=</span><span class=p>{({</span> <span class=nx>isActive</span><span class=p>,</span> <span class=nx>isPending</span><span class=p>,</span> <span class=nx>isTransitioning</span> <span class=p>})</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=nx>isPending</span> <span class=o>?</span> <span class=s2>&#34;pending&#34;</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>isActive</span> <span class=o>?</span> <span class=s2>&#34;active&#34;</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>isTransitioning</span> <span class=o>?</span> <span class=s2>&#34;transitioning&#34;</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>].</span><span class=nx>join</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=nx>end</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>Messages</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>NavLink</span><span class=p>&gt;</span>
</span></span></code></pre></div></li></ul></li><li><p>Navigating programmatically</p><ul><li><a href=https://reactrouter.com/en/main/hooks/use-navigate><code>useNavigate()</code></a></li></ul></li><li><p>Nested Routes</p><ul><li>Wrapper page that wraps other pages</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// Root.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>Outlet</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react-router-dom&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>Root</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>    	<span class=p>&lt;</span><span class=nt>Navbar</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    	<span class=p>&lt;</span><span class=nt>Outlet</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// index.js
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// omitted
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createBrowserRouter</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl> 		<span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  	<span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>Root</span> <span class=p>/&gt;,</span>
</span></span><span class=line><span class=cl>    <span class=nx>children</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=nx>index</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>HomePage</span> <span class=p>/&gt;,</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  		<span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/products&#34;</span><span class=p>,</span> <span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>ProductsPage</span> <span class=p>/&gt;,</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span></code></pre></div><ul><li>Index routes<ul><li>When a route has children, and you&rsquo;re at the parent route&rsquo;s path, the <code>&lt;Outlet></code> has nothing to render because no children match</li><li>You can think of index routes as the default child route to fill in that space</li></ul></li></ul></li><li><p>Dynamic Routes</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// index.js
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// omitted
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createBrowserRouter</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl> 		<span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  	<span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>Root</span> <span class=p>/&gt;,</span>
</span></span><span class=line><span class=cl>    <span class=nx>children</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=nx>index</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>HomePage</span> <span class=p>/&gt;,</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  		<span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;products&#34;</span><span class=p>,</span> <span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>ProductsPage</span> <span class=p>/&gt;,</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;products/:id&#34;</span><span class=p>,</span> <span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>ProductDetailPage</span> <span class=p>/&gt;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ProductDetail.jsx
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>useParams</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react-router-dom&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>ProductDetailPage</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>id</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useParams</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>  	<span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>    	<span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;{</span><span class=nx>id</span><span class=p>}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>Dynamic Segments<ul><li>If a path segment starts with <code>:</code> then it becomes a &ldquo;dynamic segment&rdquo;</li><li>When the route matches the URL, the dynamic segment will be parsed from the URL and provided as <code>params</code> to other router APIs</li></ul></li><li><a href=https://reactrouter.com/en/main/hooks/use-params><code>useParams()</code></a></li></ul></li><li><p>Handling error pages</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// Error.jsx
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>useRouteError</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react-router-dom&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>ErrorPage</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>error</span> <span class=o>=</span> <span class=nx>useRouteError</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;error-page&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span><span class=nx>Oops</span><span class=o>!</span><span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>Sorry</span><span class=p>,</span> <span class=nx>an</span> <span class=nx>unexpected</span> <span class=nx>error</span> <span class=nx>has</span> <span class=nx>occurred</span><span class=p>.&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>i</span><span class=p>&gt;{</span><span class=nx>error</span><span class=p>.</span><span class=nx>statusText</span> <span class=o>||</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>}&lt;/</span><span class=nt>i</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// index.js
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// omitted
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createBrowserRouter</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>element</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>Root</span> <span class=p>/&gt;,</span>
</span></span><span class=line><span class=cl>    <span class=nx>errorElement</span><span class=o>:</span> <span class=p>&lt;</span><span class=nt>ErrorPage</span> <span class=p>/&gt;,</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span></code></pre></div><ul><li>404 NOT FOUND</li></ul></li></ol></li><li><p>Relative & Absolute Paths</p><ul><li>Absolute path<ul><li>Path starts with <code>/</code></li><li>Describes the location from the root directory</li></ul></li><li>Relative path<ul><li>Describes the location of a file relative to the current (working) directory <code>*</code></li><li>Two dots (<code>..</code>) represent moving to a parent directory</li><li>The single dot indicates your <em>current location</em></li></ul></li></ul></li></ul><hr><h2 id=authentication>Authentication<a hidden class=anchor aria-hidden=true href=#authentication>#</a></h2><hr><h2 id=styling-react-components>Styling React Components<a hidden class=anchor aria-hidden=true href=#styling-react-components>#</a></h2><h3 id=styling-with-vanilla-css>Styling with vanilla CSS<a hidden class=anchor aria-hidden=true href=#styling-with-vanilla-css>#</a></h3><ul><li>Import CSS file into corresponding JSX file</li><li>Pros<ul><li>CSS code is decoupled from JSX code</li></ul></li><li>Cons<ul><li>You need to know CSS</li><li><strong>CSS is not scoped to components</strong>, CSS rules may clash across components</li></ul></li></ul><h3 id=scoping-styles>Scoping Styles<a hidden class=anchor aria-hidden=true href=#scoping-styles>#</a></h3><ul><li>Use inline <code>style</code> attribute<ul><li>The value is an object, not a string</li></ul></li><li>Use CSS modules<ul><li>Change <code>Component.css</code> to <code>Component.module.css</code></li><li>Change <code>import "./Component.css"</code> to <code>import classes from "./Component.module.css"</code></li><li><code>&lt;p className={classes.paragraph}>test&lt;/p></code></li></ul></li><li>CSS-IN-JS Styling with &ldquo;Styled Components&rdquo;<ul><li>Use a package <a href=https://styled-components.com/>Styled components</a></li></ul></li></ul><h3 id=styling-with-tailwind-css>Styling with Tailwind CSS<a hidden class=anchor aria-hidden=true href=#styling-with-tailwind-css>#</a></h3><ul><li>The main idea of Tailwind: add tiny utility CSS classes to HTML elements</li><li><a href=https://tailwindcss.com/>Tailwind website</a></li></ul><h3 id=dynamic-styling>Dynamic Styling<a hidden class=anchor aria-hidden=true href=#dynamic-styling>#</a></h3><ul><li>Dynamic inline styling</li><li>Dynamic styling by add class name to component dynamically, using template literal</li></ul><h3 id=animating>Animating<a hidden class=anchor aria-hidden=true href=#animating>#</a></h3><ul><li><p>Just CSS</p><ul><li><p><code>transition</code></p></li><li><p><code>@keyframes</code> and <code>animation</code></p></li></ul></li><li><p>Framer Motion</p></li></ul><hr><h2 id=testing>Testing<a hidden class=anchor aria-hidden=true href=#testing>#</a></h2><ul><li><p>Manual testing</p><ul><li>Write code -> Preview -> Improve code -> Repeat</li><li>Error-prone</li></ul></li><li><p>Automated testing</p><ul><li>Write code that automatically tests your code</li><li>Unit test<ul><li>Test the individual building blocks in isolation</li></ul></li><li>Integration test<ul><li>Test the combination of multiple building blocks</li></ul></li><li>End-to-End(E2E) test<ul><li>Test the complete scenarios / user flows in your app</li></ul></li></ul></li><li><p>Testing tools (popular) for React</p><ul><li>Tool for running our tests and asserting the results<ul><li>Jest</li></ul></li><li>Tool for &ldquo;simulating&rdquo; our React app<ul><li>React Testing Library</li></ul></li></ul></li><li><p>How to write a test</p><ul><li><p><strong>A</strong>rrange: set up test data, conditions, and environment</p></li><li><p><strong>A</strong>ct: run logic that should be tested</p></li><li><p><strong>A</strong>ssert: compare execution results with ecpected results</p></li><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-react data-lang=react><span class=line><span class=cl><span class=c1>// Component.test.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>describe</span><span class=p>(</span><span class=s2>&#34;Testing suite A&#34;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>test</span><span class=p>(</span><span class=s2>&#34;Test A&#34;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{});</span>
</span></span><span class=line><span class=cl>  <span class=nx>test</span><span class=p>(</span><span class=s2>&#34;Test B&#34;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div></li></ul></li></ul><hr><h2 id=deployment>Deployment<a hidden class=anchor aria-hidden=true href=#deployment>#</a></h2><ul><li>Deployment steps<ol><li>Test code</li><li>Optimise code</li><li>Build app</li><li>Upload app</li><li>Configure server</li></ol></li><li>Lazy loading<ul><li>Load certain components only when they are needed instead of ahead of time</li><li>Refactor from import at the top to <code>lazy()</code>, <code>import()</code>, <code>&lt;Suspend fallback={}>&lt;/Suspend></code></li></ul></li><li>Client-side routing & server-side routing</li></ul><hr><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://react.dev/learn>React Tutorial</a></li><li><a href=https://redux.js.org/introduction/getting-started>Redux Tutorial</a></li><li><a href=https://reactrouter.com/en/main>React Router</a></li><li><a href=https://www.framer.com/motion/>Framar Motion</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://hadjshell.github.io/tags/%E5%88%80%E6%B3%95how-to-play-with-sword%EF%B8%8F/>ÂàÄÊ≥ï(How to play with swordüó°Ô∏è)</a></li><li><a href=https://hadjshell.github.io/tags/react/>React</a></li></ul><nav class=paginav><a class=next href=https://hadjshell.github.io/posts/the-pragmatic-programmer/><span class=title>Next ¬ª</span><br><span>Time To Read A Book: The Pragmatic Programmer</span></a></nav></footer></article></main><footer class=footer><span>&copy; Hadjshell</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>